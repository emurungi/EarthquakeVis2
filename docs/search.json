[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Earthquake Visualisation",
    "section": "",
    "text": "1 Introduction"
  },
  {
    "objectID": "data.html#description",
    "href": "data.html#description",
    "title": "2  Data",
    "section": "2.1 Description",
    "text": "2.1 Description\n\n2.1.1 Overview of data source 1:\nWith these questions in mind, the bulk of our work will use the USGS earthquake data set here. This is because this data set contains an abundance of information about earthquakes including but not limited to: latitude, longitude, depth,time, place etc. You can find a legend of the full dataset here. Diving into the actual data set itself, each row represents one earthquake that occurred on a particular day/time. The information within the time field is extremely granular (to the exact second) and therefore if no other fields can be joined between this table and another, we can opt to join on time/day. \nWhile the data appears to be clean overall, there are some drawbacks. For one, the ‘place’ attribute appears to have an unorthodox format. In other words, it is not does not have a consistent format. While some fields include only the name of the actual region where the earthquake occurred, others include the kilometer information. This makes it hard to join on this dataset on the field ‘place.’\nThis data is very reputable as it comes from national agencies. To be specific, this source (USGS) is part of the National Earthquake Hazards Reduction Program, which is led by the National Institute of Standards and Technologies. Their goals align with the goals of our project:\n\nImprove earthquake hazard identification and risk assessment methods and their use;\nMaintain and improve comprehensive earthquake monitoring in the United States with focus on “real-time” systems in urban areas;\nImprove the understanding of earthquakes occurrence and their effects and consequences\n\n\n\n\n2.1.2 Overview of data source 2:\nTo answer the question regarding Demographics, we’ll need a dataset that describes the populations of each area in question.To make things simpler, we will focus on states as areas.\n\nThe data will describe the population in each state within the USA from 2010 to 2019. We’ve limited the scope of the years as we believe we would otherwise have too much information. This data set can be accessed here. The data set is pretty straight forward, containing  a state and its populations from 2010 to 2019. It was presented by the United States Census Bureau— an entity that aims to serve as the nation’s leading provider of quality data about its people and the economy. \nNote this data set will solely be used to find the populations of each state. The point here is that we can then leverage another table from USGS which displays the earthquakes per state. We can then join the population and earthquake table on state and time yielding a new table that contains the earthquakes per state and year. Furthermore this provides a powerful tool, we can not only see the distribution of earthquakes per state, but also how this distribution has changed over time."
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.3 Missing value analysis",
    "text": "2.3 Missing value analysis\n\nFrom the USGS Earthquakes Hazards Lists, we note that this data contains all Magnitude 7+ earthquakes that occurred in the world from 1900. The graph below shows the number of missing columns in our data. Given that we will only be using latitude,longitude, and mag, our dataset of interest has no missing values.\n\n\n\nCode\n#install.packages(\"remotes\")\n#remotes::install_github(\"jtr13/redav\")\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(tibble)\nlibrary(ggplot2)\nlibrary(forcats)\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(sf)\nlibrary(opencage)\nlibrary(redav)\nlibrary(grid)\nlibrary(tmap)\n\n\n\n\nCode\n  usgs_eq_list &lt;- read.csv('data/query.csv')\n  df_n_missing &lt;- colSums(is.na(usgs_eq_list)) %&gt;%\n      sort(decreasing = TRUE) %&gt;% as.data.frame()\n  colnames(df_n_missing) &lt;- c('n')\n  df_n_missing &lt;- rownames_to_column(df_n_missing, \"column\")\n  df_n_missing$column &lt;- fct_reorder(df_n_missing$column, df_n_missing$n, .desc = TRUE)\n  df_n_missing %&gt;% \n    ggplot() + \n    geom_col(aes(x=fct_reorder(column, n, .desc = TRUE), y=n)) + \n    theme_bw() + \n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + \n    xlab('column') + \n    ylab('Number of Missing Values')\n\n\n\n\n\n\nFrom the USGS Earthquakes by State List, the earthquake table does not actually have the name of the states within it - rather only their longitude and latitude. To get state names, we merge a shape file containing US State Boundaries as of 2018 produced by the United States Census Bureau with the earthquake data. We plot the map of earthquakes that are outside of the contiguous United States below which are depicted as null values. These arise as missing data due to the structure of the shape file geometries as the earthquakes occur outside the predefined geometries, and so do not contain a state name. These are useful as we can see they occur near the coasts of California, Alaska, Hawaii, and Canada.\n\n\n\nCode\n    us_earthquake_data &lt;- read_excel('data/eqint_tsqp.xlsx')\n    us_earthquake_data_long_lats &lt;- us_earthquake_data\n    earthquake_sf &lt;- st_as_sf(us_earthquake_data_long_lats %&gt;% drop_na(LONGITUDE, LATITUDE), coords = c(\"LONGITUDE\", \"LATITUDE\"), crs = 4326)\n    earthquake_sf &lt;- st_set_crs(earthquake_sf, 4326)\n    us_states &lt;- st_read(\"data/state_boundaries/cb_2018_us_state_20m.shp\", quiet=TRUE)\n    us_states &lt;- st_transform(us_states, 4326)\n    earthquakes_by_state &lt;- st_join(st_set_crs(earthquake_sf, 4326), \n                                    us_states, \n                                    join = st_within)\n\n\n\n\nCode\n    contiguous_us &lt;- us_states %&gt;% filter(!(NAME %in% c(\"Hawaii\", \"Puerto Rico\", \"Alaska\")))\n    hawaii &lt;- us_states %&gt;% filter(NAME %in% c(\"Hawaii\"))\n    puerto_rico &lt;- us_states %&gt;% filter(NAME %in% c(\"Puerto Rico\"))\n    alaska &lt;- us_states %&gt;% filter(NAME %in% c(\"Alaska\"))\n                                          \n    tm_shape(contiguous_us %&gt;% mutate(col=1), projection=2163) +\n        tm_polygons(\"col\", border.col = \"grey50\", border.alpha = .5, title = \"\", showNA = TRUE) +  \n      tm_shape(earthquakes_by_state %&gt;% filter(is.na(NAME))) + \n      tm_symbols(col = \"red\", size=0.1) +\n      tm_layout(\"Earthquakes outside The United States from 1852-2023\", title.position = c(\"center\", \"top\"), title.size = 2, frame = FALSE, legend.show = FALSE, inner.margins = c(0.1, 0.1, 0.05, 0.05))\n\n    m_AK &lt;- tm_shape(alaska %&gt;% mutate(col=1), projection = 3338) +\n      tm_polygons(\"col\", border.col = \"grey50\", border.alpha = .5, breaks = seq(10, 50, by = 5)) +\n      tm_layout(\"Alaska\", legend.show = FALSE, bg.color = NA, title.size = 1.5, frame = TRUE) +  \n      tm_shape(earthquakes_by_state %&gt;% filter(is.na(NAME))) + \n      tm_symbols(col = \"red\", size=0.1)\n\n    m_Hawaii &lt;- tm_shape(hawaii %&gt;% mutate(col=1), projection = 3759) +\n      tm_polygons(\"col\", border.col = \"grey50\", border.alpha = .5, breaks = seq(10, 50, by = 5)) +\n      tm_layout(\"Hawaii\", legend.show = FALSE, bg.color = NA, title.size = 1.5, frame = TRUE) +  \n      tm_shape(earthquakes_by_state %&gt;% filter(is.na(NAME))) + \n      tm_symbols(col = \"red\", size=0.1)\n\n    m_Puerto_Rico &lt;- tm_shape(puerto_rico %&gt;% mutate(col=1), projection = 3338) +\n      tm_polygons(\"col\", border.col = \"grey50\", border.alpha = .5, breaks = seq(10, 50, by = 5)) +\n      tm_layout(\"Puerto Rico\", legend.show = FALSE, bg.color = NA, title.size = 1.5, frame = TRUE) +  \n      tm_shape(earthquakes_by_state %&gt;% filter(is.na(NAME))) + \n      tm_symbols(col = \"red\", size=0.1)\n\n    print(m_AK, vp=viewport(x= 0.15, y= 0.1, width= 0.3, height= 0.3))\n    print(m_Hawaii, vp=viewport(x= 0.8, y= 0.1, width= 0.2, height= 0.2))\n    print(m_Puerto_Rico, vp=viewport(x= 0.6, y= 0.1, width= 0.2, height= 0.2))\n\n\n\n\n\nWe’ve decided to drop these records as they only comprise 15% of our data, and are not significantly detracting from our purpose of analyzing population vs earthquakes.\n\n\nCode\n    earthquakes_by_state_df &lt;- earthquakes_by_state %&gt;% st_drop_geometry()\n    earthquakes_by_state_df %&gt;% mutate(State_Label = ifelse(is.na(NAME), \"Null State Name\", 'Contains State Name'), earthquake=\"earthquake\") %&gt;% ggplot() + geom_bar(aes(x=earthquake, fill=State_Label), position=\"stack\") + xlab(NULL) + ylab(\"Count\")\n\n\n\n\n\n\nFinally, for the population data, after some pre-cleaning on the Excel file, we note that there are no missing values for the years available between 2010-2019\n\n\n\nCode\n    population_data &lt;- read_excel('data/nst-est2019-01.xlsx')\n    population_data &lt;- population_data %&gt;% pivot_longer(cols=!`Geographic Area`, names_to = \"Year\", values_to = \"population\")\n    plot_missing(population_data, percent=FALSE)"
  },
  {
    "objectID": "conclusion.html",
    "href": "conclusion.html",
    "title": "5  Conclusion",
    "section": "",
    "text": "Our data analysis (shown in the results section) has enabled us to draw some conclusions that solved our original questions. As a reminder we have attached our questions below, and will subsequently answer them.\nGeographical Elements:\n- What is the distribution of earthquakes on land versus in the ocean?(US Data) - What is the distribution of earthquakes with respect to fault lines?\nTime Elements:\n- Are there discernible patterns in the time series of earthquakes, indicating seasonality or other temporal trends? (US Data) - We will break this down into earthquakes over different months, as well as over different years. (US Data)\nDemographic Elements:\n- How close do earthquakes occur to population and US city centers? (Note we are using US city centers as states due to the lack of datasets in other countries).\nSeverity of damage:\n- What is the distribution of magnitudes for earthquakes over time?(US Data)\nGeographical Elements: Most earthquakes occur on Land. The Mosiac plot we created highlighted this pretty clearly. Additionally the plot described the phenomenon we see with horizontal error—a way to measure location error with earthquakes. We can see that if an Earthquake occurs in the Ocean then it is more likely to have a measurement error. This makes intuitive sense, yet is still something to consider when when making policy around earthquake measurement in ocean exposed areas.\n\n\n\n\n\nWe also found that earthquakes tend to occur most near fault lines, with most locations in our global dataset occuring near or around these lines. This is an important factor to be considered by tourists planning to visit these locations for the holidays.\n\n\n\n\n\nTime Elements: According to our analysis, a simple line chart showed that most earthquakes within the USA occurred in the month of November. This is an interesting month to occur, however our hunch is that this is when the seasonality is changing from summer to winter across the country, and thereby there could be larger seismic activity because of this change. This does not neccessary mean that winter has more earthquakes because its more consdusive to said events—on the contrary January and December have some of the lowest counts of Earthquakes. Additionally, we also noticed that later decades, 1900s and 2000s experienced much more earthquakes than earlier on. One possibility was that it became much easier to capture these events later on due to tech etc and thus they appear more in the dataset. These are things that are definetely imporant for both policy makers and tourists. Tourists should be cautious of the timings of theiir travel to areas that are especially exposed to earthquakes and polcy makers should be aware, and continue to try creating tech that can detect more and more earthquakes.\n\n\n\n\n\n\n\n\n\n\nDemographic Elements: We found that the states with the most earthquakes prominently occured on the west coast of America, with California leading the counts by far. However, with respect to magnitude, Idaho has by far the largest average magnitude per earthquake. Below is the plot for the average magnitude per state.\n\n\nCode\n#| warning: false\n#| message: false\n#| echo: false\n# Group by state, calculate the average magnitude across all years\n\n\n# Assuming your data frame is named 'your_data'\n\n# Drop rows with NA values\nstate_earthquakes_selected_cleaned &lt;- na.omit(state_earthquakes_selected)\n\n# Select one row per state, grouping by and getting the average\none_per_state  &lt;- state_earthquakes_selected_cleaned %&gt;% mutate(col_a = 1) %&gt;% select(state = NAME, magnitude=MAGNITUDE) %&gt;% group_by(state) %&gt;% summarise(magnitude=mean(magnitude))\n\n\n\nggplot(one_per_state, aes(x = magnitude)) +\n  geom_bar(stat = \"identity\", aes(y=fct_reorder(state, magnitude)),fill = \"skyblue\") +\n  labs(title = \"Average Magnitude Per State for 1638-1985\", x =  \"Average Magnitude\", y = \"State\") +\n  theme_minimal()\n\n\n\n\n\nIn order to diisplay the counts of earthquakes per state, we decided to create a clevland dot plot, faceted by the quantiles, where each quantile holds the states that exist in that quantile. For example Washington is within the 4th quantile because the number of earthquakes it has puts it at the fourth quantile. Additionally, we colored the points to show how year impacts the occurence of Earthquakes. What was most obvious was how , as we found before, later decades tended to have higher earthquake counts overall. In addition to this we got to inspect how certain states may have higher earthquake counts than others. As we mentioned California had by far the highest. Illinois, New york and Hawaii were next during later decades. Upon inspection it seemed as though these were states were those with higher population counts. In order to confirm this we created a faceted scatter plot shown below.\n\n\nCode\n# Pivot the table so we have one row per year and state\n#| echo: false\n\npopulation_per_state &lt;- state_pop %&gt;%\n  pivot_longer(cols = starts_with(\"x\"),\n               names_to = \"year\",\n               values_to = \"population\") %&gt;%\n  arrange(State, year)\n\n# Display the updated data frame\n# population_per_state\n\n\n\n\n\n\n\nAs we can see the correlation for low and high magnitude earthquake counts is slightly positive indicating that higher population states tend to have higher earthquake counts. This makes sense as these are the states often closer to fault lines. What this highlights though is tha tpolicy makers need to ensure these states hold heavier protection against earthquakes as they contain more people.\nSeverity Damage: We captured the sevirty damage of earthquakes by analyzing the severity as the magnitude Our interest lied in the question of whether or not the severity changed over time. If it did in the positive direction, that is the overall variance and median of magnitudes has increased over time, then it could mean that we as a population are doing something to trigger these events, and could therefore notify Policy makers. Below is a box plot of distributions of magnitude for every decade in our dataset. What we can evidently see is that until 1930, the variance of earthquake magnitudes were extremely low, with a high median. As the decades progressed, the variance increased largely but the median decreased. This confirms our previously thought theory that technology improved overtime allowing us to predict small and large earthquakes better thereby increasing the variance of captured earthquake’s magnitude overall. We do not need to be concerned, therefore, of human led earthquake activity.\n\n\n`summarise()` has grouped output by 'DECADE_START', 'YEAR', 'MONTH', 'DAY'. You\ncan override using the `.groups` argument."
  },
  {
    "objectID": "data.html#research-plan",
    "href": "data.html#research-plan",
    "title": "2  Data",
    "section": "2.2 Research Plan",
    "text": "2.2 Research Plan\nThe primary dataset is of earthquakes of magnitude 7+ from the USGS Earthquakes Hazards Lists and Maps. With this data, we seek to answer each research question using the following aspects of the data.\n\nWhat is the distribution of earthquakes on land versus in the ocean?\nLeveraging the latitude and longitude columns for epicenter location, we can use the sf package to categorize earthquakes as occurring on land or in the ocean. This additional column aids in examining the distribution of earthquakes over time and facilitates visualizing differences in magnitudes through a comparative boxplot for land and ocean locations.\n\n\n\nAre there discernible patterns in the time series of earthquakes, indicating seasonality or other temporal trends?\nUsing the time column, which spans from 1905 to 2023 and includes UTC time up to the millisecond level of occurrence, we can plot major earthquakes against their respective time. Our goal is to identify any seasonality in the data, determine which year experienced the highest frequency of major earthquakes, and explore monthly patterns in earthquake occurrences.\nHow close do earthquakes occur to population and city centers?\nSimilar to our inquiry about proximity to fault lines, we aim to investigate the relationship between earthquake occurrence and population centers in the U.S. To achieve this, we will merge two datasets based on cities – one containing population data as of 2023 and the other detailing earthquakes by city in the United States. We anticipate exploring trends at both the national and state levels, with the hope of uncovering any correlations or trends, such as a potential negative correlation between earthquake occurrence and population size."
  },
  {
    "objectID": "d3graph.html",
    "href": "d3graph.html",
    "title": "4  Interactive graph",
    "section": "",
    "text": "Number of Earthquakes Per State in a decade\n\n\nEach decade can be adjusted with a slider. It is clear that California has the highest number of earthquakes per year each decade but we also see that the number of earthquakes is highly dependent on the decade due to measurement bias.\n\n\n\n\nSelect Decade:  1630"
  }
]